#include <iom48v.h>
#include <macros.h>
#include "HWFS.h"
#include "suma.h"
uint k2;
void hongwaifashe(void)
{ 
  BFS;				   //发射端常高电压
  ZZ(0x56);
}


  void ZZ(uchar x)
{ 
  TT0(1,12);		   //发射载波9ms
  TT0(0,12);	       //不发射载波4.5mS
  /*用户码+用户反码+命令码+命令反码*/
  Z0(x);

}
/*????????????????????????????????????????????????????????????
单字节发送程序
????????????????????????????????????????????????????????????*/
void Z0(uchar temp)
{ 
  uchar v;
  for (v=0;v<8;v++)                     //循环八次数据移位 
       {       
			 if(temp&0x01) TT0(1,6); //无脉冲信号1690us
			 else          TT0(0,6);  //无脉冲信号560us   
			 temp >>= 1;                //右移一位
        }    
}

/*????????????????????????????????????????????????????????????
1、38khz脉冲发射+延时程序
2、（是否发射脉冲：1：发射、0：不发射，延时x（us））
????????????????????????????????????????????????????????????*/
void TT0(uint a,uint b,uint c,uint t,uint BT,uint x)
{
  if(BT == 0)
  {		BFS;
  	    delay(a,b,c,x/6);
  }	//BT=0时不发送脉冲只延时，BT=1时发送脉冲且延时
  else {	   FS;
   	   		delay(a,b,c,x/6); }
  BFS;			        //发射端常常高电压态
}
